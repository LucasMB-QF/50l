<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Documentos</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        #btn-group button {
            margin: 0 5px 15px 0;
            padding: 10px 15px;
            cursor: pointer;
        }
        #btn-group button.active {
            background-color: #007BFF;
            color: white;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        button.action-btn {
            margin-right: 10px;
            padding: 5px 10px;
            cursor: pointer;
        }
        #pdf-viewer-container {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        #pdf-viewer-container.active {
            display: flex;
        }
        #pdf-viewer {
            width: 80vw;
            height: 80vh;
            border: none;
            background: white;
        }
        #viewer-title {
            color: white;
            margin-bottom: 10px;
            font-size: 1.2em;
            text-align: center;
        }
        #close-pdf {
            position: absolute;
            top: 15px;
            right: 30px;
            background: #ff4c4c;
            border: none;
            color: white;
            font-size: 1.2em;
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 3px;
        }
    </style>
</head>
<body>

    <div id="btn-group">
        <button id="btn-dq" class="active">DQ</button>
        <button id="btn-oq">OQ</button>
        <button id="btn-pq">PQ</button>
    </div>

    <div id="documents-container"></div>

    <div id="pdf-viewer-container">
        <button id="close-pdf">Cerrar ✕</button>
        <div>
            <div id="viewer-title"></div>
            <iframe id="pdf-viewer" src=""></iframe>
        </div>
    </div>

    <script>
        const documents = {
          dq: [
            { id: '1RxjMR-8Nfxw7uqmH5LIpjtMPAOKdHIBg', name: 'INFORME FINAL DQ', type: 'pdf', size: '4.2 MB' },
            { id: '1dwxsjsuGGsjIbUq1jlkM_qXCvX5Z0s0d', name: 'PROTOCOLO DQ', type: 'pdf', size: '3.5 MB' },
            { id: '1p4VECW2GPcNptowOLl0b3qMLnd96Jlt8', name: 'ANEXO 1 DQ', type: 'pdf', size: '5.9 MB' },
            { id: '13NUOWSTyeVxRZElRwzf2-nqeO1P7pWsN', name: 'ANEXO 2 DQ', type: 'pdf', size: '3.5 MB' },
            { id: '1ygQqx--Du4qGjAIFh05o_pUHqxaGn2Ha', name: 'ANEXO 3 DQ', type: 'pdf', size: '1.8 MB' },
            { id: '1y7CR-jPHhUvUbInM3EEQ0IaRI0x8Z_nN', name: 'ANEXO 4 DQ', type: 'pdf', size: '2.7 MB' },
            { id: '1JRsSZrrUtBBp5oO9p0u60ymodhf0xIub', name: 'ANEXO DESV DQ', type: 'pdf', size: '1.2 MB' }
          ],
          oq: [
            { id: '1bMoPGZVSzepAlix49vOZ-QaVh5t9g9DQ', name: 'INFORME FINAL OQ', type: 'pdf', size: '1.2 MB' },
            { id: '1tAcbsZXcR7tZT4drMDnOQukyTU_ad0Il', name: 'PROTOCOLO OQ', type: 'pdf', size: '4 MB' },
            { id: '1j4YQ8ppIvOaaWsBeqL9ZxvWOqiKFN5vG', name: 'ANEXO 1 OQ', type: 'pdf', size: '678 KB' },
            { id: '1WeX4RzxEqCKlNTpOZiFZUUsdTT4BAfof', name: 'ANEXO 2 OQ', type: 'pdf', size: '3.6 MB' },
            { id: '12LZhk-oUOxJyDBAfte8xaJ1FbRxtq9Z7', name: 'ANEXO 3 OQ', type: 'pdf', size: '1.7 MB' },
            { id: '1olFmbEW6zk1dss4hZ0u9ONhLjQXdDFbo', name: 'ANEXO 4 OQ', type: 'pdf', size: '1.7 MB' },
            { id: '11jKp3C_K6hkfCZhhi1q7VOWJBuM0Ie6K', name: 'ANEXO 5 OQ', type: 'pdf', size: '1.7 MB' },
            { id: '1kfRsBhlJfr0BnmiLk07XsOF6U7Tyhs-a', name: 'ANEXO 6 OQ', type: 'pdf', size: '1.7 MB' },
            { id: '16qVc_5gIkMYaZKoKD3Gf7bNkozq2VqKK', name: 'ANEXO 7 OQ', type: 'pdf', size: '906 KB' },
            { id: '13I1Z-3alFLXdumlR0avyOHOYpeOnzev5', name: 'MKT Perfil cálido, carga mínima.xlsm', type: 'xlsm', size: '409 KB', previewLink: 'https://docs.google.com/spreadsheets/d/13I1Z-3alFLXdumlR0avyOHOYpeOnzev5/preview' },
            { id: '1qfXCTEoWDT6epDk7pp0-jcd7o6MXvNLN', name: 'MKT Perfil frío, carga mínima.xlsm', type: 'xlsm', size: '367 KB', previewLink: 'https://docs.google.com/spreadsheets/d/1qfXCTEoWDT6epDk7pp0-jcd7o6MXvNLN/preview' },
            { id: '1AIcshtEYsCsu82c14G8Fj3l0OincBXwY', name: 'MKT Perfil cálido, carga máxima.xlsm', type: 'xlsm', size: '373 KB', previewLink: 'https://docs.google.com/spreadsheets/d/1AIcshtEYsCsu82c14G8Fj3l0OincBXwY/preview' },
            { id: '1t54Lgy-xSwkgiDTczDOWHjDFUWkoeMfy', name: 'MKT Perfil frío, carga máxima.xlsm', type: 'xlsm', size: '355 KB', previewLink: 'https://docs.google.com/spreadsheets/d/1t54Lgy-xSwkgiDTczDOWHjDFUWkoeMfy/preview' }
          ],
          pq: [
            { id: '1bz2QpJTfAIpM97vCCElxE_KK-1OAN5U4', name: 'INFORME FINAL PQ', type: 'pdf', size: '1 MB' },
            { id: '15XHbUBAqgQlVN8-hYzmjdwQ4hSBF9stM', name: 'PROTOCOLO PQ', type: 'pdf', size: '6.6 MB' },
            { id: '1IzDv5t2MIViA5z-4aqPdmpX2FoqyfWXh', name: 'ANEXO 1 PQ', type: 'pdf', size: '3.5 MB' },
            { id: '1uvNac5Eo7XzZjr0i9A-dHmt6yHa7dNc9', name: 'ANEXO 2 PQ', type: 'pdf', size: '1.9 MB' },
            { id: '1zIFG6D9d-oCp8VrBbWAaBbk9_kOUM5Y3', name: 'ANEXO 3 PQ', type: 'pdf', size: '1.6 MB' },
            { id: '1aNoo63ri9yprcLNiL3GC6HYsJoRwYADj', name: 'ANEXO 4 PQ', type: 'pdf', size: '2 MB' },
            { id: '1JqoyGOmwSem_fihJvhz6TSjJhsNqSOJV', name: 'ANEXO 5 PQ', type: 'pdf', size: '1.7 MB' },
            { id: '1NRQbVUp0qAoiSLHzLfeyCq1mt3Ikc5LH', name: 'ANEXO 6 PQ', type: 'pdf', size: '1.6 MB' },
            { id: '1rqchegSKzcdyYhKQUf90U3GWy0cwu-6b', name: 'ANEXO 7 PQ', type: 'pdf', size: '2.5 MB' },
            { id: '1BimC7kg1PPyCeIVKALu2ikn3S1hYMFp4', name: 'ANEXO DESV PQ', type: 'pdf', size: '432 KB' },
            { id: '13I1Z-3alFLXdumlR0avyOHOYpeOnzev5', name: 'MKT CPO, carga mínima.xlsm', type: 'xlsm', size: '409 KB', previewLink: 'https://docs.google.com/spreadsheets/d/13I1Z-3alFLXdumlR0avyOHOYpeOnzev5/preview' },
            { id: '1rDR45SvGwjZ8LXmlRp8_NTBthNcdmamV', name: 'MKT PMC, carga mínima.xlsm', type: 'xlsm', size: '332 KB', previewLink: 'https://docs.google.com/spreadsheets/d/1rDR45SvGwjZ8LXmlRp8_NTBthNcdmamV/preview' },
            { id: '1KlqnGHL_zq7IvaOlr-JvBnQQbAr5ujwt', name: 'MKT CPO, carga máxima.xlsm', type: 'xlsm', size: '397 KB', previewLink: 'https://docs.google.com/spreadsheets/d/1KlqnGHL_zq7IvaOlr-JvBnQQbAr5ujwt/preview' },
            { id: '1ygNzzjI6xEmazGKCj8no7j61zFaXQEo8', type: 'xlsm', name: 'MKT PMC, carga máxima.xlsm', size: '373 KB', previewLink: 'https://docs.google.com/spreadsheets/d/1ygNzzjI6xEmazGKCj8no7j61zFaXQEo8/preview' },
            { id: '17vVo7eaF9XXU2gHC9iVAjqGXG_Mv3vlL', name: 'DESV MKT PMC, carga mínima.xlsm', type: 'xlsm', size: '441 KB', previewLink: 'https://docs.google.com/spreadsheets/d/17vVo7eaF9XXU2gHC9iVAjqGXG_Mv3vlL/preview' }
          ]
        };

        const btnDq = document.getElementById('btn-dq');
        const btnOq = document.getElementById('btn-oq');
        const btnPq = document.getElementById('btn-pq');
        const documentsContainer = document.getElementById('documents-container');
        const pdfViewerContainer = document.getElementById('pdf-viewer-container');
        const pdfViewer = document.getElementById('pdf-viewer');
        const viewerTitle = document.getElementById('viewer-title');
        const closePdfBtn = document.getElementById('close-pdf');

        let currentCategory = 'dq';

        function renderDocuments(category) {
            documentsContainer.innerHTML = '';
            const docs = documents[category];
            if (!docs || docs.length === 0) {
                documentsContainer.innerHTML = '<p>No hay documentos para mostrar.</p>';
                return;
            }
            const table = document.createElement('table');
            const thead = document.createElement('thead');
            thead.innerHTML = `<tr>
                <th>Nombre</th>
                <th>Tipo</th>
                <th>Tamaño</th>
                <th>Acciones</th>
            </tr>`;
            table.appendChild(thead);
            const tbody = document.createElement('tbody');

            docs.forEach(doc => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${doc.name}</td>
                    <td>${doc.type.toUpperCase()}</td>
                    <td>${doc.size}</td>
                    <td>
                        ${doc.type === 'pdf' ? `<button class="action-btn" onclick="viewDocument('${doc.id}', '${doc.name}', '${doc.type}')">Ver</button>` : ''}
                        ${doc.type === 'xlsm' && doc.previewLink ? `<button class="action-btn" onclick="openDocumentPreview('${doc.previewLink}')">Abrir</button>` : ''}
                        <button class="action-btn" onclick="downloadDocument('${doc.id}', '${doc.name}')">Descargar</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });

            table.appendChild(tbody);
            documentsContainer.appendChild(table);
        }

        function viewDocument(id, name, type) {
            if (type === 'pdf') {
                const url = `https://drive.google.com/file/d/${id}/preview`;
                pdfViewer.src = url;
                viewerTitle.textContent = name;
                pdfViewerContainer.classList.add('active');
            } else {
                alert('Vista previa solo disponible para PDFs. Por favor descargue el archivo.');
            }
        }

        function openDocumentPreview(previewLink) {
            window.open(previewLink, '_blank');
        }

        function downloadDocument(id, name) {
            const url = `https://drive.google.com/uc?export=download&id=${id}`;
            const link = document.createElement('a');
            link.href = url;
            link.download = name;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        closePdfBtn.addEventListener('click', () => {
            pdfViewerContainer.classList.remove('active');
            pdfViewer.src = '';
        });

        function setActiveButton(activeBtn) {
            [btnDq, btnOq, btnPq].forEach(btn => btn.classList.remove('active'));
            activeBtn.classList.add('active');
        }

        btnDq.addEventListener('click', () => {
            currentCategory = 'dq';
            setActiveButton(btnDq);
            renderDocuments('dq');
        });

        btnOq.addEventListener('click', () => {
            currentCategory = 'oq';
            setActiveButton(btnOq);
            renderDocuments('oq');
        });

        btnPq.addEventListener('click', () => {
            currentCategory = 'pq';
            setActiveButton(btnPq);
            renderDocuments('pq');
        });

        // Render initial documents
        renderDocuments(currentCategory);
    </script>

</body>
</html>
